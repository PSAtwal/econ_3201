---
title: |
  | ECON 3201 
  | Econometrics for Economics and Finance
subtitle: |
    | Assignment 2
    | Due Friday October 3, 2025
author: Parambir Singh Atwal
format: 
  pdf:
    include-in-header: 
      text: |
        \usepackage{fancyhdr}
        \fancypagestyle{style1}{
        \fancyhf{}
        \fancyfoot[C]{\thepage}
        \renewcommand{\headrulewidth}{0.4pt}
        }

        \fancypagestyle{style2}{
        \fancyhf{}
        \fancyhead[R]{Assignment 2}
        \fancyhead[C]{Name: Parambir Singh Atwal, Student No. 3196537}
        \fancyhead[L]{ECON 3201}
        \fancyfoot[C]{\thepage}
        \renewcommand{\headrulewidth}{1pt}
        }
        \pagestyle{style2}
execute: 
  eval: true
  echo: false
---
```{r}
  library(tikzDevice)
  library(ggplot2)
```


# Instructions {-}

Answer all questions. Please complete your assignment using Quarto. Submit both your Quarto file and pdf output file. 

# 1. The Normal Distribution

Write your solutions using LaTeX. Show your work. You may use R to compute the answers. 

1.1. Let $X=\{1,2,3,4,5,6,7,8,9,10,11,12$ be a uniformly distributed variable with probability distribution function $f_X(x)=1/12$.
    
  (a) Check that $f_X(x)$ is a true probability distribution. 
# We need to satisfy the following 2 conditions: 
# Condition 1:
    $f_X(x) = 1/12 \geq 0$ for all $x$
# Condition 2:
    $\sum_{x=1}^{12} \frac{1}{12} = 12 \times \frac{1}{12} = 1$
# Conditions met, hence verified. 

  (b) Compute the expected value of $X$.
#Ans (b)
    $E[X] = \sum_{x=1}^{12} x \cdot \frac{1}{12} = \frac{1}{12} \times 78 = 6.5$
    
# I did this one manually since the use of R was optional for this one. 
  (c) Compute the variance of $X$. 
    $E[X^2] = \sum_{x=1}^{12} x^2 \cdot \frac{1}{12} = \frac{1}{12} \times 650 = 54.1667$ 
    $Var(X) = 54.1667 - (6.5)^2 = 11.9167$
    
&nbsp;
    
1.2. Let $X\sim N(4,5)$. Find the probability of each event:
  
  (a) $Pr(X\leq6)$ 
```{r}
  # (a)
  cat("Pr(X ≤ 6) =", round(pnorm(6, mean = 4, sd = sqrt(5)), 4), "\n")
```
  
  (b) $Pr(X>4)$
```{r}
cat("Pr(X > 4) =", round(1 - pnorm(4, mean = 4, sd = sqrt(5)), 4), "\n")
```
  
  (c) $Pr(-1\leq X< 1)$
```{r}
cat("Pr(-1 ≤ X < 1) =", round(pnorm(1, mean = 4, sd = sqrt(5)) - pnorm(-1, mean = 4, sd = sqrt(5)), 4), "\n")
```

  &nbsp;


1.3. Let $Z\sim N(0,1)$. 
  
  (a) Compute $Pr(Z\leq 0.83)$
```{r}  
# (a)
cat("Pr(Z ≤ 0.83) =", round(pnorm(0.83), 4), "\n")
```
  
  (b) Compute $Pr(-0.83 \leq Z\leq 0.83)$
```{r}
# (b)
cat("Pr(-0.83 ≤ Z ≤ 0.83) =", round(pnorm(0.83) - pnorm(-0.83), 4), "\n")
```

&nbsp;

# 2. R Excercises

&nbsp;

2.1. Let $X=\{1,2,3,4,5,6,7,8,9,10,11,12$ be a uniformly distributed variable with probability distribution function $f_X(x)=1/12$.
    
  (a) Plot the probability distribution function $f_X(x)$ in R.
  (b) Plot the cumulative probability distribution function $f_X(x) in R$.
  (c) Compute the expected value of $X$ in R.
  (d) Compute the variance of $X$ in R. 
```{r}
x <- 1:12
fx <- rep(1/12, 12)

# (a)
plot(x, fx, type = "h", lwd = 3, 
     xlab = "x", 
     ylab = "f_X(x)", 
     main = "PDF")

# (b)
plot(x, cumsum(fx), type = "s", lwd = 2, 
     xlab = "x", 
     ylab = "F_X(x)", 
     main = "CDF")

# (c)
cat("Expected value =", sum(x * fx), "\n")

# (d)
ex2 <- sum(x^2 * fx)
cat("Variance =", round(ex2 - (sum(x * fx))^2, 4), "\n")
```

&nbsp;

2.2 The standard normal distribution function is given by $$f(x)=\frac{e^{-(x^2/2)}}{\sqrt{2\pi}\sigma}$$

  (a) Define this function in R. (Note: $\pi$ is coded as `pi` and $e$ is coded as `exp`. 
  (b) Integrate this function over the limit [$-\infty,\infty$] using the `integrate()` command in R. Infinity in R is written as `Inf`. To evaluate the integral, use `integrate()$value`
  (c) Compute the expected value of the standard normal distribution in R and confirm it is equal to 0.
  (d) Compute the variance of the standard normal distribution in R and confirm it is equal to 1. 
  (e) Compute $Pr(Z\leq 0.83)$
  (f) Compute $Pr(-0.83 \leq Z\leq 0.83)$
  (g) Compute $Pr(-0.83 \leq Z\leq 0.83)$ using the `pnorm()` command and compare your results to (f).
  
```{r}
# Ans. (a)
f_std_norm <- function(x) {
  exp(-(x^2)/2) / sqrt(2 * pi)
}

# Ans. (b)
cat("Integral =", integrate(f_std_norm, lower = -Inf, upper = Inf)$value, "\n")

# Ans. (c)
cat("Expected value =", integrate(function(x) x * f_std_norm(x), lower = -Inf, upper = Inf)$value, "\n")

# Ans. (d)
ex2_std <- integrate(function(x) x^2 * f_std_norm(x), lower = -Inf, upper = Inf)$value
cat("Variance =", ex2_std, "\n")

# Ans. (e)
cat("Pr(Z ≤ 0.83) =", round(integrate(f_std_norm, lower = -Inf, upper = 0.83)$value, 4), "\n")

# Ans. (f)
cat("Pr(-0.83 ≤ Z ≤ 0.83) =", round(integrate(f_std_norm, lower = -0.83, upper = 0.83)$value, 4), "\n")

# Ans. (g)
cat("Using pnorm =", round(pnorm(0.83) - pnorm(-0.83), 4), "\n")
```

&nbsp;

2.3 Let $X$ denote the prison sentence, in years, for people convicted of auto theft in a particular province in Canada. Suppose the PDF of $X$ is given by: $$f(X)=\frac{1}{9}x^2,\text{ }0<x<3.$$

  (a) Define $f(x)$ in R.
  (b) Integrate $f(x)$ over the interval [0,3].
  (c) Compute the expected prison sentence. 
```{r}
# Ans (a)
f_prison <- function(x) {
  (1/9) * x^2
}

# Ans (b)
cat("Integral =", integrate(f_prison, lower = 0, upper = 3)$value, "\n")

# Ans (c)
cat("Expected sentence =", integrate(function(x) x * f_prison(x), lower = 0, upper = 3)$value, "years\n")
```

&nbsp;

2.4 Let $X$ follow a Student $t$ distribution with $M$ degrees of freedom. Then $$X=\frac{Z}{\sqrt{W/M}}\sim t_M,$$ where $Z$ is a standard normal variable and $W$ is a chi-squared variable with $M$ degrees of freedom.

  (a) On the same figure plot the following:
      (i) Plot the standard normal probability distribution using `curve()`. Specify the range as [-5,5] using `xlim`. Name the `ylab` "Density". The main title should be "Densities of t Distribution". 
      (ii) Plot the Student t distribution with 5 degrees of freedom using `curve()` and `dt()`.  Specify the range as [-5,5] using `xlim`. Choose a different colour, i.e. `col=2`. To learn more about `dt`, type `?dt` in your console. 
      (iii) Plot the Student t distribution with 15 degrees of freedom using `curve()` and `dt()`.  Specify the range as [-5,5] using `xlim`. Choose a different colour, i.e. `col=3`. To learn more about `dt`, type `?dt` in your console.
      (iv) Plot the Student t distribution with 25 degrees of freedom using `curve()` and `dt()`.  Specify the range as [-5,5] using `xlim`. Choose a different colour, i.e. `col=4`. To learn more about `dt`, type `?dt` in your console.
      (v) Include the following legend in you plot:\
          `legend("topright",`\ 
          `c("N(0, 1)", "M=2", "M=4", "M=25"),`\ 
          `col = 1:4,`\ 
          `lty = c(1, 1, 1, 1))`\

```{r}
# Ans 2.4
curve(dnorm(x), from = -5, to = 5, 
      xlim = c(-5, 5), 
      ylab = "Density", 
      main = "Densities of t Distribution", 
      col = 1, 
      lwd = 2)
curve(dt(x, df = 5), from = -5, to = 5, add = TRUE, col = 2, lwd = 2)
curve(dt(x, df = 15), from = -5, to = 5, add = TRUE, col = 3, lwd = 2)
curve(dt(x, df = 25), from = -5, to = 5, add = TRUE, col = 4, lwd = 2)

# I think it may have been omitted by mistake so I added M=15 in the legend below.

legend("topright", 
       c("N(0, 1)", "M=5", "M=15", "M=25"), 
       col = 1:4, 
       lty = 1, 
       lwd = 2)
```
          
          
  (b) What do you observe as the degrees of freedom increase?
## As degrees of freedom increase, the t-distribution becomes more similar to the standard normal distribution i.e., its curve flattens out more and more. I think we also touched upon this briefly in one of our recent classes. 
